import{r as b,o as p,c as F,a as w,E as N,d as H,b as L,e as q,f as v,g as s,n as E,w as $,v as x,u as i,t as f,h as D,p as U,i as V,j as c,k as Y,l as K,m as h,q as Z,s as j,F as B,x as O,y as tt,_ as J,z as et,A as ot,B as st,C as W,D as nt,G as it,H as at,I as rt,V as G,J as lt,K as dt,L as ut,M as ct,N as pt,O as ht}from"./vendor.9dc52952.js";const _t=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function o(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerpolicy&&(r.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?r.credentials="include":a.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(a){if(a.ep)return;a.ep=!0;const r=o(a);fetch(a.href,r)}};_t();var T=(t,e)=>{const o=t.__vccOpts||t;for(const[n,a]of e)o[n]=a;return o};const mt={};function vt(t,e){const o=b("router-view");return p(),F(o)}var ft=T(mt,[["render",vt]]);const A={GET:"/notebooks",ADD:"/notebooks",UPDATE:"/notebooks/:id",DELETE:"./notebooks/:id"},S={GET:"/notes/from/:notebookId",ADD:"/notes/to/:notebookId",UPDATE:"/notes/:noteId",DELETE:"/notes/:noteId"},P={REGISTER:"/auth/register",LOGIN:"/auth/login",LOGOUT:"/auth/logout",GET_INFO:"/auth"},R={GET:"/notes/trash",REVERT:"/notes/:noteId/revert",DELETE:"/notes/:noteId/confirm"};w.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded";w.defaults.baseURL="https://note-server.hunger-valley.com";w.defaults.withCredentials=!0;w.defaults.validateStatus=t=>t>=200&&t<300||t===400;function _(t,e="GET",o={}){return new Promise((n,a)=>{let r={url:t,method:e};e.toLowerCase()==="get"?r.params=o:r.data=o,w(r).then(d=>{d.status===200?n(d.data):(N.error(d.data.msg),a(d.data))}).catch(()=>{N.error("\u7F51\u7EDC\u5F02\u5E38"),a({msg:"\u7F51\u7EDC\u5F02\u5E38"})})})}const M=H({id:"user",state:()=>({user:null}),getters:{username:t=>t.user===null?"\u672A\u767B\u5F55":t.user.username},actions:{login({username:t,password:e}){return _(P.LOGIN,"POST",{username:t,password:e}).then(o=>{this.user=o.data,I.push({path:"/evernote"}).catch(n=>console.log(n))})},register({username:t,password:e}){return _(P.REGISTER,"POST",{username:t,password:e}).then(o=>{this.user=o.data,I.push({path:"/evernote"}).catch(n=>console.log(n))})},logout(){return _(P.LOGOUT).then(()=>{this.user=null,I.push({path:"/login"}).catch(t=>console.log(t))})},checkLogin(){return _(P.GET_INFO).then(t=>{t.isLogin?this.user=t.data:I.push({path:"/login"}).catch(e=>console.log(e))})}}});const kt=t=>(U("data-v-4b5274f9"),t=t(),V(),t),bt={id:"page-bg"},gt=kt(()=>s("h1",{class:"page-title"},"\u6668\u65ED\u7B14\u8BB0",-1)),Nt={class:"form"},Et={class:"page-tabs"},Tt={key:0,class:"login"},yt={key:1,class:"register"},Ct={setup(t){const e=L(!0),o=L(!1),n=L(null),a=q({username:"",password:"",isError:!1}),r=q({username:"",password:"",isError:!1}),d=M(),k=m=>{if(!/^[\w\u4e00-\u9fa5]{3,15}$/.test(m.username)){m.isError=!0,n.value="\u7528\u6237\u540D\u4E3A3~15\u4E2A\u5B57\u7B26\uFF0C\u652F\u6301 _ \u3001\u5B57\u6BCD\u3001\u6570\u5B57\u3001\u4E2D\u6587";return}if(!/^.{6,16}$/.test(m.password)){m.isError=!0,n.value="\u5BC6\u7801\u957F\u5EA6\u4E3A6~16\u4E2A\u5B57\u7B26";return}m.isError=!1,n.value=null},g=()=>{k(a),d.login({username:a.username,password:a.password}).catch(m=>{a.isError=!0,n.value=m.msg})},C=()=>{k(r),d.register({username:r.username,password:r.password}).catch(m=>{r.isError=!0,n.value=m.msg})};return(m,l)=>(p(),v("main",bt,[gt,s("div",Nt,[s("nav",Et,[s("h2",{class:E({show:e.value}),onClick:l[0]||(l[0]=u=>[e.value,o.value]=[o.value,e.value])}," \u767B\u5F55",2),s("h2",{class:E({show:o.value}),onClick:l[1]||(l[1]=u=>[e.value,o.value]=[o.value,e.value])}," \u6CE8\u518C",2)]),e.value?(p(),v("section",Tt,[$(s("input",{"onUpdate:modelValue":l[2]||(l[2]=u=>i(a).username=u),type:"text",placeholder:"\u7528\u6237\u540D"},null,512),[[x,i(a).username]]),$(s("input",{"onUpdate:modelValue":l[3]||(l[3]=u=>i(a).password=u),type:"password",placeholder:"\u5BC6\u7801"},null,512),[[x,i(a).password]]),s("p",{class:E({error:i(a).isError})},f(n.value),3),s("button",{onClick:g},"\u767B\u5F55")])):D("",!0),o.value?(p(),v("section",yt,[$(s("input",{"onUpdate:modelValue":l[4]||(l[4]=u=>i(r).username=u),type:"text",placeholder:"\u8BBE\u7F6E\u7528\u6237\u540D",onInput:l[5]||(l[5]=u=>k(i(r)))},null,544),[[x,i(r).username]]),$(s("input",{"onUpdate:modelValue":l[6]||(l[6]=u=>i(r).password=u),onInput:l[7]||(l[7]=u=>k(i(r))),placeholder:"\u8BBE\u7F6E\u5BC6\u7801",type:"password"},null,544),[[x,i(r).password]]),s("p",{class:E({error:i(r).isError})},f(n.value),3),s("button",{onClick:C},"\u6CE8\u518C")])):D("",!0)])]))}};var Q=T(Ct,[["__scopeId","data-v-4b5274f9"]]);const wt=["title"],Lt={class:"username"},$t={setup(t){const e=M();return e.checkLogin(),setInterval(function(){e.checkLogin()},12e4),(o,n)=>(p(),v("div",{class:"avatar",title:`\u7528\u6237\u540D\uFF1A${i(e).username}`},[c(i(Y),{class:"userIcon"}),s("span",Lt,f(i(e).username),1)],8,wt))}};var xt=T($t,[["__scopeId","data-v-17b4ce1a"]]);const X=H({id:"store",state:()=>({notebooks:null,notebook:null,notes:[],note:null,trashNotes:null}),getters:{notebookList:t=>t.notebooks||[],curNotebook:t=>t.notebook||{},noteList:t=>t.notes||[],curNote:t=>t.note||{title:"",content:""},trashNoteList:t=>t.trashNotes||[]},actions:{promptBox(t,e,o=null){return K.prompt(e,t,{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",inputPattern:/^.{1,30}$/,inputValue:o,inputErrorMessage:"\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A\uFF0C\u4E14\u4E0D\u8D85\u8FC730\u4E2A\u5B57\u7B26",customClass:"customClass",cancelButtonClass:"cancelButtonClass",confirmButtonClass:"confirmButtonClass"})},confirmBox(t,e){return K.confirm(e,t,{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",customClass:"customClass",cancelButtonClass:"cancelButtonClass",confirmButtonClass:"confirmButtonClass",type:"warning"})},getNotebookList(){return this.notebooks!==null?Promise.resolve():new Promise((t,e)=>{_(A.GET).then(o=>{o.data=o.data.sort((n,a)=>a.createdAt===n.createdAt?0:n.createdAt<a.createdAt?1:-1),this.notebooks=o.data,this.setCurNotebook(),t(o)}).catch(o=>e(o))})},initialize(){return new Promise((t,e)=>{_(A.ADD,"POST",{title:"\u9ED8\u8BA4\u7B14\u8BB0\u672C"}).then(o=>{this.notebooks.unshift(o.data),this.setCurNotebook(),t(o)}).catch(o=>e(o))})},addNotebook(){this.promptBox("\u521B\u5EFA\u7B14\u8BB0\u672C","\u8F93\u5165\u65B0\u7B14\u8BB0\u672C\u7684\u6807\u9898").then(({value:t})=>new Promise((e,o)=>{_(A.ADD,"POST",{title:t}).then(n=>{this.notebooks.unshift(n.data),N.success(n.msg),this.setCurNotebook(),e(n)}).catch(n=>o(n))}))},deleteNotebook(t){this.confirmBox("\u5220\u9664\u7B14\u8BB0\u672C","\u786E\u8BA4\u8981\u5220\u9664\u8BE5\u7B14\u8BB0\u672C\u5417").then(()=>_(A.DELETE.replace(":id",this.notebook.id),"DELETE")).then(e=>{this.notebook=this.notebooks[this.notebookList.indexOf(this.notebook)+1]||this.notebooks[0],this.notebooks=this.notebooks.filter(o=>o.id!==t),this.setCurNotebook(this.notebook.id),N.success(e.msg)})},editNotebookTitle(){this.promptBox("\u4FEE\u6539\u7B14\u8BB0\u672C","\u8F93\u5165\u65B0\u7B14\u8BB0\u672C\u7684\u6807\u9898",this.notebook.title).then(({value:t})=>_(A.UPDATE.replace(":id",this.notebook.id),"PATCH",{title:t}).then(()=>{let e=this.notebooks.find(o=>o.id===this.notebook.id)||{};e.title=t}))},setCurNotebook(t=null){if(this.notebooks.length!==0)return this.notebook=this.notebooks.find(e=>e.id===t)||this.notebooks[0],new Promise((e,o)=>{_(S.GET.replace(":notebookId",this.notebook.id)).then(n=>{n.data=n.data.sort((a,r)=>r.updatedAt===a.updatedAt?0:a.updatedAt<r.updatedAt?1:-1),this.notes=n.data,this.setCurNote(),e(n)}).catch(n=>o(n))})},creationTimeNoteList(){this.notes=this.notes.sort((t,e)=>e.createdAt===t.createdAt?0:t.createdAt<e.createdAt?1:-1)},recentUpdateNoteList(){this.notes=this.notes.sort((t,e)=>e.updatedAt===t.updatedAt?0:t.updatedAt<e.updatedAt?1:-1)},AlphabeticallyNoteList(){this.notes=this.notes.sort((t,e)=>e.title===t.title?0:t.title<e.title?1:-1)},setCurNote(t=null){this.note=this.notes.find(e=>e.id===t)||this.notes[0]},addNote({title:t="",content:e=""}={title:"",content:""}){return new Promise((o,n)=>{_(S.ADD.replace(":notebookId",this.notebook.id),"POST",{title:t,content:e}).then(a=>{this.notes.unshift(a.data),this.note=this.notes[0],o(a)}).catch(a=>{n(a)})})},updateNote(){return _(S.UPDATE.replace(":noteId",this.note.id),"PATCH",{title:this.curNote.title,content:this.curNote.content}).then(()=>{let t=this.notes.find(e=>e.id===this.curNote.id)||{};t.title=this.curNote.title,t.content=this.curNote.content})},deleteNote(){return _(S.DELETE.replace(":noteId",this.note.id),"DELETE").then(()=>{this.notes=this.notes.filter(t=>t.id!==this.note.id),this.note=this.notes[this.notes.indexOf(this.note)+1]||this.notes[0]})},getTrashNoteList(){return new Promise((t,e)=>{_(R.GET).then(o=>{o.data=o.data.sort((n,a)=>a.updatedAt===n.updatedAt?0:n.updatedAt<a.updatedAt?1:-1),this.trashNotes=o.data,t(o)}).catch(o=>e(o))})},trashNoteBelongTo(t){return(this.notebooks.find(o=>o.id===t)||{}).title||""},deleteTrashNote(t){this.confirmBox("\u5220\u9664\u7B14\u8BB0","\u786E\u8BA4\u8981\u5220\u9664\u8BE5\u7B14\u8BB0\u5417\uFF0C\u5220\u9664\u540E\u5C06\u6C38\u4E45\u65E0\u6CD5\u6062\u590D").then(()=>_(R.DELETE.replace(":noteId",t),"DELETE")).then(e=>{this.trashNotes=this.trashNotes.filter(o=>o.id!==t),N.success(e.msg)})},revertTrashNote(t){return _(R.REVERT.replace(":noteId",t.id),"PATCH").then(e=>{this.trashNotes=this.trashNotes.filter(o=>o.id!==t.id),this.setCurNotebook(t.notebookId),N.success(e.msg)})}}});const y=t=>(U("data-v-701b1152"),t=t(),V(),t),At=y(()=>s("span",{class:"page-title"},"\u6668\u65ED\u7B14\u8BB0",-1)),It=y(()=>s("span",null,"\u521B\u5EFA\u7B14\u8BB0\u672C",-1)),Dt=y(()=>s("span",null,"\u6211\u7684\u7B14\u8BB0\u672C",-1)),Bt={class:"title-wrapper"},St={class:"notebookTitle"},Pt=y(()=>s("span",null,"\u56DE\u6536\u7AD9",-1)),Ut={class:"trash-header"},Vt={class:"trash-title"},Ot=y(()=>s("div",{class:"trash-info"},[s("span",null,"\u7B14\u8BB0\u540D\u79F0"),s("span",null,"\u66F4\u65B0\u65F6\u95F4"),s("span",null,"\u6240\u5C5E\u7B14\u8BB0\u672C"),s("span",null,"\u64CD\u4F5C")],-1)),Gt={class:"trash-note-list"},Rt={class:"trash-note-title"},Mt={class:"last-updated-time"},zt={class:"trash-more-operations"},Ft=["onClick"],Ht=["onClick"],qt={href:"https://github.com/wujinghaoyyds/evernote-vue/blob/main/README.md",class:"web-intro",target:"_blank"},Kt=y(()=>s("span",null,"\u5173\u4E8E",-1)),Jt={setup(t){const e=L(!1),o=M(),n=X();return n.getNotebookList().then(()=>{n.notebookList.length===0&&n.initialize().then(()=>{n.addNote({title:"\u6B22\u8FCE\u4F7F\u7528\u6668\u65ED\u7B14\u8BB0",content:"\u6B22\u8FCE\u6B22\u8FCE\uFF0C\u70ED\u70C8\u6B22\u8FCE\u3002\u66F4\u591A\u5185\u5BB9\u67E5\u770B\uFF1Ahttps://zhuanlan.zhihu.com/p/466859830"}),n.getNotebookList()})}),(a,r)=>{const d=b("el-header"),k=b("el-menu-item"),g=b("el-scrollbar"),C=b("el-sub-menu"),m=b("el-drawer"),l=b("el-menu");return p(),v("aside",null,[c(d,null,{default:h(()=>[At]),_:1}),c(xt),c(l,{"default-active":"2","default-openeds":["2"],"background-color":"#161B22"},{default:h(()=>[c(k,{index:"1",class:"addNotebook",onClick:r[0]||(r[0]=u=>i(n).addNotebook())},{default:h(()=>[c(i(Z),{class:"styleIcon"}),It]),_:1}),c(C,{index:"2"},{title:h(()=>[c(i(j),{class:"styleIcon"}),Dt]),default:h(()=>[c(g,{"max-height":"200px"},{default:h(()=>[(p(!0),v(B,null,O(i(n).notebookList,u=>(p(),F(k,{index:u.id.toString(),key:u.id,class:E({active:u.id===i(n).curNotebook.id}),onClick:z=>i(n).setCurNotebook(u.id)},{default:h(()=>[s("div",Bt,[c(i(tt),{class:"styleIcon"}),s("span",St,f(u.title),1)])]),_:2},1032,["index","class","onClick"]))),128))]),_:1})]),_:1}),c(k,{index:"3"},{default:h(()=>[s("div",{class:"trash-link",onClick:r[1]||(r[1]=u=>e.value=!0)},[c(i(J),{class:"styleIcon"}),Pt]),c(m,{modelValue:e.value,"onUpdate:modelValue":r[2]||(r[2]=u=>e.value=u),title:"I am the title",size:"calc(100vw - 210px)","modal-class":"mask-layer-opacity","show-close":!1,onOpen:r[3]||(r[3]=u=>i(n).getTrashNoteList())},{title:h(()=>[s("div",Ut,[s("span",Vt,"\u56DE\u6536\u7AD9\u5171\u6709 "+f(i(n).trashNoteList.length)+" \u7BC7\u7B14\u8BB0",1),Ot])]),default:h(()=>[c(g,{class:"trash-list"},{default:h(()=>[s("ol",Gt,[(p(!0),v(B,null,O(i(n).trashNoteList,u=>(p(),v("li",null,[s("span",Rt,f(u.title?u.title:"<\u65E0\u6807\u9898\u7B14\u8BB0>"),1),s("span",Mt,f(new Date(u.updatedAt).toLocaleDateString()+new Date(u.updatedAt).toLocaleTimeString()),1),s("span",null,f(i(n).trashNoteBelongTo(u.notebookId)),1),s("span",zt,[s("button",{class:"completely-delete",onClick:z=>i(n).deleteTrashNote(u.id)},"\u5F7B\u5E95\u5220\u9664",8,Ft),s("button",{class:"recover",onClick:z=>i(n).revertTrashNote(u)},"\u6062\u590D",8,Ht)])]))),256))])]),_:1})]),_:1},8,["modelValue"])]),_:1}),c(k,{index:"4"},{default:h(()=>[c(i(et),{class:"styleIcon"}),s("span",{onClick:r[4]||(r[4]=u=>i(o).logout())},"\u9000\u51FA\u767B\u5F55")]),_:1}),c(k,{index:"5"},{default:h(()=>[s("a",qt,[c(i(ot),{class:"styleIcon"}),Kt])]),_:1})]),_:1})])}}};var Wt=T(Jt,[["__scopeId","data-v-701b1152"]]);const Qt=t=>(U("data-v-1c4d6b69"),t=t(),V(),t),Xt={id:"note-sidebar"},Yt={class:"notebook-info"},Zt={class:"notebook-related"},jt={class:"notebook-title"},te={class:"more-operation"},ee=Qt(()=>s("li",{class:"sort-order"},"\u6392\u5E8F\u65B9\u5F0F",-1)),oe={class:"note-related"},se={class:"note-list"},ne=["onClick"],ie={class:"note-title"},ae={class:"update-time"},re={key:0,class:"note-empty"},le={key:1,id:"note-edit"},de={class:"edit-header"},ue={class:"edit-status"},ce={setup(t){const e=X(),o=L("\u7B14\u8BB0\u5C06\u81EA\u52A8\u4FDD\u5B58"),n=()=>{e.updateNote().then(()=>{o.value="\u5DF2\u4FDD\u5B58"}).catch(()=>{o.value="\u4FDD\u5B58\u51FA\u9519"})},a=st.debounce(function(){!e.curNote.id||e.updateNote().then().catch(()=>{o.value="\u4FDD\u5B58\u51FA\u9519"})},3e3);return(r,d)=>{const k=b("el-tooltip"),g=b("el-scrollbar"),C=b("el-empty"),m=b("v-md-editor");return p(),v(B,null,[s("div",Xt,[s("header",Yt,[s("div",Zt,[s("span",jt,f(i(e).curNotebook.title),1),c(k,{placement:"bottom-end",trigger:"click","show-arrow":!1,offset:1},{content:h(()=>[s("ul",te,[s("li",{onClick:d[0]||(d[0]=W(l=>i(e).editNotebookTitle(),["stop","prevent"]))},"\u4FEE\u6539\u6807\u9898"),s("li",{onClick:d[1]||(d[1]=W(l=>i(e).deleteNotebook(i(e).curNotebook.id),["stop","prevent"]))},"\u5220\u9664"),ee,s("li",{onClick:d[2]||(d[2]=l=>i(e).creationTimeNoteList())},"\u521B\u5EFA\u65F6\u95F4"),s("li",{onClick:d[3]||(d[3]=l=>i(e).recentUpdateNoteList())},"\u66F4\u65B0\u65F6\u95F4"),s("li",{onClick:d[4]||(d[4]=l=>i(e).AlphabeticallyNoteList())},"\u6587\u4EF6\u540D\u79F0")])]),default:h(()=>[s("span",null,[c(i(nt),{class:"more-operation-icon"})])]),_:1})]),s("div",oe,[s("span",null,"\u7B14\u8BB0\u5217\u8868\uFF08"+f(i(e).noteList.length)+"\uFF09",1),s("button",{class:"add-note",onClick:d[5]||(d[5]=l=>i(e).addNote())},"\u6DFB\u52A0\u7B14\u8BB0")])]),c(g,null,{default:h(()=>[s("ol",se,[(p(!0),v(B,null,O(i(e).noteList,l=>(p(),v("li",{key:"note.id",class:E({active:l.id===i(e).curNote.id}),onClick:u=>i(e).setCurNote(l.id)},[s("span",ie,f(l.title?l.title:"<\u65E0\u6807\u9898\u7B14\u8BB0>"),1),s("div",null,[s("div",ae,[c(i(it),{class:"update-icon"}),s("span",null,f(new Date(l.updatedAt).toLocaleDateString()+new Date(l.updatedAt).toLocaleTimeString()),1)]),c(i(J),{class:"delete-note-icon",onClick:d[6]||(d[6]=u=>i(e).deleteNote())})])],10,ne))),128))])]),_:1})]),i(e).curNote.id?D("",!0):(p(),v("div",re,[c(C,{description:"\u8BF7\u521B\u5EFA\u7B14\u8BB0"})])),i(e).curNote.id?(p(),v("div",le,[s("header",de,[$(s("input",{class:"edit-note-title",type:"text","onUpdate:modelValue":d[7]||(d[7]=l=>i(e).curNote.title=l),onInput:d[8]||(d[8]=(...l)=>i(a)&&i(a)(...l)),placeholder:"\u6DFB\u52A0\u6807\u9898"},null,544),[[x,i(e).curNote.title]]),s("span",ue,f(o.value),1)]),c(m,{modelValue:i(e).curNote.content,"onUpdate:modelValue":d[9]||(d[9]=l=>i(e).curNote.content=l),onChange:i(a),onSave:n,height:"calc(100vh - 40px)"},null,8,["modelValue","onChange"])])):D("",!0)],64)}}};var pe=T(ce,[["__scopeId","data-v-1c4d6b69"]]);const he={class:"layout"},_e={setup(t){return(e,o)=>(p(),v("div",he,[c(Wt),c(pe)]))}};var me=T(_e,[["__scopeId","data-v-b4f4ac76"]]);const ve=[{path:"/evernote",component:me},{path:"/login",component:Q},{path:"/",component:Q}],I=at({history:rt(),routes:ve});G.Codemirror=lt;G.use(dt,{Hljs:ut});ct(ft).use(pt).use(G).use(I).use(ht()).mount("#app");
